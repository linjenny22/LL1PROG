import datetime as dt

t = dt.datetime.now().date()

data_path = r'S:\Contracts\Research and IT\08 - MWBE\DAS Only\09 - Python and R Scripts\LL1 PROG\PRODUCTION\Datasets'

def date_range(t):
    if t.month >= 7 and t.month <= 9:
        date_range_start = dt.date(t.year - 1, 7, 1) #Dates for whole cumulative year.
        date_range_end = dt.date(t.year, 6, 30)
        FY = t.year
        FQ = 'Q4'
    elif t.month >= 10 and t.month <= 12:
        date_range_start = dt.date(t.year, 7, 1) #First Quarter
        date_range_end = dt.date(t.year, 9, 30)
        FY = t.year + 1
        FQ = 'Q1'
    elif t.month >= 1 and t.month <= 3:
        date_range_start = dt.date(t.year - 1, 7, 1) #Second Quarter
        date_range_end = dt.date(t.year - 1, 12, 31)
        FY = t.year
        FQ = 'Q2'
    elif t.month >= 4 and t.month <= 6:
        date_range_start = dt.date(t.year - 1, 7, 1) #Third Quarter
        date_range_end = dt.date(t.year, 3, 31)
        FY = t.year
        FQ = 'Q3'
    return [date_range_start, date_range_end, FQ, FY]

[date_range_start, date_range_end, FQ, FY] = date_range(t)

start_date = str(date_range_start.month) + '/' + str(date_range_start.day) + '/' + str(date_range_start.year)
end_date = str(date_range_end.month) + '/' + str(date_range_end.day) + '/' + str(date_range_end.year)

list = (str(FY), str(FQ), str(FY), str(FQ), str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY), str(FQ),str(FY), str(FQ),str(FY)[2:4], start_date, end_date, str(FY)[2:4], start_date, end_date, str(FY)[2:4], start_date, end_date, str(FY)[2:4], start_date, end_date, str(FY)[2:4],start_date, end_date, str(FY)[2:4],start_date, end_date, str(FY)[2:4], start_date, end_date, str(FY)[2:4], start_date, end_date)

prime_util = r"""SELECT tblMainTable_OpenContracts.Agency, tblMainTable_OpenContracts.DOC_CD, tblMainTable_OpenContracts.DOC_DEPT_CD, tblMainTable_OpenContracts.DOC_ID, tblMainTable_OpenContracts.ContractID, tblMainTable_OpenContracts.EPIN, IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]) AS Industry2, IIf([ReportCategory],"MWBE","Not MWBE") AS MWBE_Status, tblSBS_MWBE%s_%s.ReportCategory, tblSBS_MWBE%s_%s.EthGen, tblMainTable_OpenContracts.ContractValue, IIf([ContractValue]<=20000 And [Industry]<>"Construction Services","Micro Purchase",IIf([ContractValue]<=35000 And [Industry]="Construction Services","Micro Purchase",IIf([ContractValue]>20000 And [Industry]<>"Construction Services" And [ContractValue]<=100000,"Small Purchase",IIf([ContractValue]>35000 And [Industry]="Construction Services" And [ContractValue]<=100000,"Small Purchase",IIf([ContractValue]>100000 And [ContractValue]<=1000000,">$100K, <=$1M",IIf([ContractValue]>1000000 And [ContractValue]<=5000000,">$1M, <=$5M",IIf([ContractValue]>5000000 And [ContractValue]<=25000000,">$5M, <=$25M",IIf([ContractValue]>25000000,">$25M","NA")))))))) AS SizeGroup, tblMainTable_OpenContracts.MWBE_LL, tblMainTable_OpenContracts.Method, tblMainTable_OpenContracts.VendorName, tblMainTable_OpenContracts.VendorTIN, tblMainTable_OpenContracts.VendorNumber, tblMainTable_OpenContracts.Purpose, R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN, tblMainTable_OpenContracts.StartDate, tblMainTable_OpenContracts.EndDate, tblMainTable_OpenContracts.REG_FY, tblMainTable_OpenContracts.REG_MONTH, tblMainTable_OpenContracts.REG_FQ, tblMainTable_OpenContracts.Size_Group, tblMainTable_OpenContracts.RegistrationDate, tblMainTable_OpenContracts.Industry, tblMainTable_OpenContracts.NoTSPReason, tblMainTable_OpenContracts.ExcludeAll, tblMainTable_OpenContracts.ExcludeCategory, tblMainTable_OpenContracts.STATE_FED_FUNDED, tblMainTable_OpenContracts.MWBE72Fed
FROM (tblMainTable_OpenContracts LEFT JOIN R_NonProfit_HHS_IRS_VENDNO_FY%s ON tblMainTable_OpenContracts.VendorTIN = R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) LEFT JOIN tblSBS_MWBE%s_%s ON tblMainTable_OpenContracts.VendorNumber = tblSBS_MWBE%s_%s.FMS_Vendor_ID
WHERE (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry) Not In ("Goods","Human Services")) AND ((tblMainTable_OpenContracts.NoTSPReason) Is Null) AND ((tblMainTable_OpenContracts.ExcludeAll)=False)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.ContractValue)<=100000) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry)="Goods") AND ((tblMainTable_OpenContracts.NoTSPReason) Is Null) AND ((tblMainTable_OpenContracts.ExcludeAll)=False)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry) Not In ("Goods","Human Services")) AND ((tblMainTable_OpenContracts.NoTSPReason) Not In (1,3,6,7,8,11,12)) AND ((tblMainTable_OpenContracts.ExcludeAll)=False)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.ContractValue)<=100000) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry)="Goods") AND ((tblMainTable_OpenContracts.NoTSPReason) Not In (1,3,6,7,8,11,12)) AND ((tblMainTable_OpenContracts.ExcludeAll)=False)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry) Not In ("Goods","Human Services")) AND ((tblMainTable_OpenContracts.NoTSPReason) Is Null) AND ((tblMainTable_OpenContracts.ExcludeAll)=True) AND ((tblMainTable_OpenContracts.ExcludeCategory)=16)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.ContractValue)<=100000) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry)="Goods") AND ((tblMainTable_OpenContracts.NoTSPReason) Is Null) AND ((tblMainTable_OpenContracts.ExcludeAll)=True) AND ((tblMainTable_OpenContracts.ExcludeCategory)=16)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry) Not In ("Goods","Human Services")) AND ((tblMainTable_OpenContracts.NoTSPReason) Not In (1,3,6,7,8,11,12)) AND ((tblMainTable_OpenContracts.ExcludeAll)=True) AND ((tblMainTable_OpenContracts.ExcludeCategory)=16)) OR (((tblMainTable_OpenContracts.Agency)<>"OMB") AND ((tblMainTable_OpenContracts.DOC_CD)<>"CTA1" And (tblMainTable_OpenContracts.DOC_CD)<>"RCT1") AND ((tblMainTable_OpenContracts.DOC_DEPT_CD)<>"040") AND ((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]))<>"Non-Procurement") AND ((tblMainTable_OpenContracts.ContractValue)<=100000) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.VendorNumber) Not In ("0000775990","0000947209","0000650614","0000949814","0000947155")) AND ((R_NonProfit_HHS_IRS_VENDNO_FY%s.EIN) Is Null) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Industry)="Goods") AND ((tblMainTable_OpenContracts.NoTSPReason) Not In (1,3,6,7,8,11,12)) AND ((tblMainTable_OpenContracts.ExcludeAll)=True) AND ((tblMainTable_OpenContracts.ExcludeCategory)=16))
ORDER BY tblMainTable_OpenContracts.Agency;""" % list

slist = (str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY)[2:4],str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY)[2:4], str(FY), str(FQ), str(FY), str(FQ), str(start_date), str(end_date), str(start_date), str(end_date))

sub_util = r"""SELECT qryOpenContracts_FY%s_Goals.Agency, qryOpenContracts_FY%s_Goals.ContractID, qryOpenContracts_FY%s_Goals.Method, qryOpenContracts_FY%s_Goals.Industry AS PrimeIndustry, IIf([Industry]="Architecture/Engineering","Professional Services",[Industry]) AS PrimeIndustry2, qryOpenContracts_FY%s_Goals.ContractValue AS PrimeContractValue, qryOpenContracts_FY%s_Goals.ExcludeAll, qryOpenContracts_FY%s_Goals.ExcludeCategory, tblSubcontracts_FMS3.PrimaryKey, tblSubcontracts_FMS3.SubIndustry, Replace(Replace(Replace(Replace(IIf([SubIndustry]="Arch and Enginrng" Or [SubIndustry]="Architecture/Engineering","Professional Services",IIf([SubIndustry]="Other",[PrimeIndustry2],[SubIndustry])),"Construction Services","Construction"),"Standardized Services","Standard Services"),"Construction","Construction Services"),"Standard Services","Standardized Services") AS SubIndustry2, tblSubcontracts_FMS3.SubValue, IIf([SubValue]<=20000,"<=$20K",IIf([SubValue]>20000 And [SubValue]<=100000,">$20K, <=$100K",IIf([SubValue]>100000 And [SubValue]<=1000000,">$100K, <=$1M",IIf([SubValue]>1000000 And [SubValue]<=5000000,">$1M, <=$5M",IIf([SubValue]>5000000 And [SubValue]<=25000000,">$5M, <=$25M",IIf([SubValue]>25000000,">$25M","NA")))))) AS SizeGroup, tblSubcontracts_FMS3.SubStartDate, tblSBS_MWBE2019_Q3.ReportCategory, qryOpenContracts_FY19_Goals.TSP, qryOpenContracts_FY19_Goals.Goal_Black, qryOpenContracts_FY19_Goals.Goal_Asian, qryOpenContracts_FY19_Goals.Goal_Hispanic, qryOpenContracts_FY19_Goals.Goal_Woman, qryOpenContracts_FY19_Goals.Goal_Unspecified, qryOpenContracts_FY19_Goals.RegistrationDate, tblSBS_MWBE2019_Q3.EthGen, tblSubcontracts_FMS3.Duplicate, tblSubcontracts_FMS3.Source, tblSubcontracts_FMS3.SubVendorName, tblSubcontracts_FMS3.SubVendorNumber, tblSubcontracts_FMS3.SubDescr, IIf([ReportCategory],"MWBE","Not MWBE") AS MWBE_Status, qryOpenContracts_FY19_Goals.MWBE_LL, IIf(IsNull([SubStartDate]),"No Registration Date",IIf(Month([SubStartDate])=7 Or Month([SubStartDate])=8 Or Month([SubStartDate])=9,"Q1",IIf(Month([SubStartDate])=10 Or Month([SubStartDate])=11 Or Month([SubStartDate])=12,"Q3",IIf(Month([SubStartDate])=1 Or Month([SubStartDate])=2 Or Month([SubStartDate])=3,"Q3",IIf(Month([SubStartDate])=4 Or Month([SubStartDate])=5 Or Month([SubStartDate])=6,"Q4","Error"))))) AS FQuarter
FROM (qryOpenContracts_FY%s_Goals INNER JOIN tblSubcontracts_FMS3 ON (qryOpenContracts_FY%s_Goals.DOC_ID = tblSubcontracts_FMS3.DOC_ID) AND (qryOpenContracts_FY%s_Goals.DOC_DEPT_CD = tblSubcontracts_FMS3.DOC_DEPT_CD) AND (qryOpenContracts_FY%s_Goals.DOC_CD = tblSubcontracts_FMS3.DOC_CD)) LEFT JOIN tblSBS_MWBE%s_%s ON tblSubcontracts_FMS3.SubVendorNumber = tblSBS_MWBE%s_%s.FMS_VENDOR_ID
WHERE (((tblSubcontracts_FMS3.SubStartDate) Between #%s# And #%s#) AND ((tblSubcontracts_FMS3.Duplicate)=False) AND ((tblSubcontracts_FMS3.Source)<>"CTGL") AND ((IIf([SubIndustry]="Arch and Enginrng" Or [SubIndustry]="Architecture/Engineering","Professional Services",[SubIndustry]))<>"Goods" And (IIf([SubIndustry]="Arch and Enginrng" Or [SubIndustry]="Architecture/Engineering","Professional Services",[SubIndustry]))<>"Human Services")) OR (((tblSubcontracts_FMS3.SubValue)<=100000) AND ((tblSubcontracts_FMS3.SubStartDate) Between #%s# And #%s#) AND ((tblSubcontracts_FMS3.Duplicate)=False) AND ((tblSubcontracts_FMS3.Source)<>"CTGL") AND ((qryOpenContracts_FY19_Goals.MWBE_LL)="LL129") AND ((IIf([SubIndustry]="Arch and Enginrng" Or [SubIndustry]="Architecture/Engineering","Professional Services",[SubIndustry])) Not In ("Goods","Standard Services","Human Services")));""" % (slist)

pg_list = (str(FY), str(FQ),str(FY), str(FQ), str(FY), str(FQ), str(FY), str(FQ),str(start_date), str(end_date),str(start_date), str(end_date))

prime_goals = r"""SELECT tblMainTable_OpenContracts.Agency, tblMainTable_OpenContracts.DOC_CD, tblMainTable_OpenContracts.DOC_DEPT_CD, tblMainTable_OpenContracts.DOC_ID, tblMainTable_OpenContracts.ContractID, tblMainTable_OpenContracts.EPIN, IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry]) AS Industry2, IIf([ReportCategory],"MWBE","Not MWBE") AS MWBE_Status, tblSBS_MWBE%s_%s.ReportCategory, tblSBS_MWBE%s_%s.EthGen, tblMainTable_OpenContracts.ContractValue, IIf([ContractValue]<=20000 And [Industry]<>"Construction Services","Micro Purchase",IIf([ContractValue]<=35000 And [Industry]="Construction Services","Micro Purchase",IIf([ContractValue]>20000 And [Industry]<>"Construction Services" And [ContractValue]<=100000,"Small Purchase",IIf([ContractValue]>35000 And [Industry]="Construction Services" And [ContractValue]<=100000,"Small Purchase",IIf([ContractValue]>100000 And [ContractValue]<=1000000,">$100K, <=$1M",IIf([ContractValue]>1000000 And [ContractValue]<=5000000,">$1M, <=$5M",IIf([ContractValue]>5000000 And [ContractValue]<=25000000,">$5M, <=$25M",IIf([ContractValue]>25000000,">$25M","NA")))))))) AS SizeGroup, tblMainTable_OpenContracts.RegistrationDate, tblMainTable_OpenContracts.MWBE_LL, tblMainTable_OpenContracts.Method, tblMainTable_OpenContracts.VendorName, tblMainTable_OpenContracts.VendorTIN, tblMainTable_OpenContracts.VendorNumber, tblMainTable_OpenContracts.Purpose, R_NonProfit_HHS_IRS_VENDNO_FY19.EIN, tblMainTable_OpenContracts.StartDate, tblMainTable_OpenContracts.EndDate, tblMainTable_OpenContracts.NoTSPReason, tblMainTable_OpenContracts.TSP, tblMainTable_OpenContracts.Goal_Black, tblMainTable_OpenContracts.Goal_Asian, tblMainTable_OpenContracts.Goal_Hispanic, tblMainTable_OpenContracts.Goal_Woman, tblMainTable_OpenContracts.Goal_Unspecified, tblMainTable_OpenContracts.MWBE_GOALS, tblMainTable_OpenContracts.STATE_FED_FUNDED
FROM (tblMainTable_OpenContracts LEFT JOIN tblSBS_MWBE%s_%s ON tblMainTable_OpenContracts.VendorNumber = tblSBS_MWBE%s_%s.FMS_VENDOR_ID) LEFT JOIN R_NonProfit_HHS_IRS_VENDNO_FY19 ON tblMainTable_OpenContracts.VendorTIN = R_NonProfit_HHS_IRS_VENDNO_FY19.EIN
WHERE (((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry])) Not In ("Non-Procurement","Human Services","Goods")) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase","MWBE 72")) AND ((tblMainTable_OpenContracts.NoTSPReason) Is Null) AND ((tblMainTable_OpenContracts.MWBE_GOALS)=True) AND ((tblMainTable_OpenContracts.ExcludeAll) Is Null Or (tblMainTable_OpenContracts.ExcludeAll)=False)) OR (((IIf([tblMainTable_OpenContracts.Industry]="Architecture/Engineering","Professional Services",[Industry])) Not In ("Non-Procurement","Human Services","Goods")) AND ((tblMainTable_OpenContracts.RegistrationDate) Between #%s# And #%s#) AND ((tblMainTable_OpenContracts.Method) In ("Accelerated","Competitive Sealed Bid","Demonstration Project","Innovative","Micro Purchase","Negotiated Acquisition","Negotiated Acquisition Extension","Renewal","Request for Proposal","Small Purchase","Micropurchase")) AND ((tblMainTable_OpenContracts.NoTSPReason) Not In (1,3,6,7,8,11,12)) AND ((tblMainTable_OpenContracts.MWBE_GOALS)=True) AND ((tblMainTable_OpenContracts.ExcludeAll) Is Null Or (tblMainTable_OpenContracts.ExcludeAll)=False))
ORDER BY tblMainTable_OpenContracts.Agency;""" % pg_list

print (prime_util)
print (sub_util)
print (prime_goals)




